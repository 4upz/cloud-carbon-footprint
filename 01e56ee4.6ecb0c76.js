(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{122:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return f}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=a.a.createContext({}),p=function(e){var t=a.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=p(e.components);return a.a.createElement(c.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},d=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,c=u(e,["components","mdxType","originalType","parentName"]),s=p(n),d=r,f=s["".concat(i,".").concat(d)]||s[d]||b[d]||o;return n?a.a.createElement(f,l(l({ref:t},c),{},{components:n})):a.a.createElement(f,l({ref:t},c))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var c=2;c<o;c++)i[c]=n[c];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},73:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return u})),n.d(t,"default",(function(){return p}));var r=n(3),a=n(7),o=(n(0),n(122)),i={id:"creating-a-lookup-table",title:"Creating a Lookup Table"},l={unversionedId:"creating-a-lookup-table",id:"creating-a-lookup-table",isDocsHomePage:!1,title:"Creating a Lookup Table",description:"In order to support the big data processing requirements that some organizations have, it may be more practical or efficient for you to compute carbon metrics within your existing processing. To do so, we support the generation of a look up table that can be utilized as an additional step in your pipeline.",source:"@site/docs/CreatingALookupTable.md",slug:"/creating-a-lookup-table",permalink:"/docs/creating-a-lookup-table",version:"current",sidebar:"tryNowSidebar",previous:{title:"Running the CLI",permalink:"/docs/running-the-cli"},next:{title:"Performance Configurations",permalink:"/docs/performance-configurations"}},u=[{value:"Example queries to create input CSV file",id:"example-queries-to-create-input-csv-file",children:[{value:"AWS - Athena Query",id:"aws---athena-query",children:[]}]}],c={toc:u};function p(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"In order to support the big data processing requirements that some organizations have, it may be more practical or efficient for you to compute carbon metrics within your existing processing. To do so, we support the generation of a look up table that can be utilized as an additional step in your pipeline."),Object(o.b)("p",null,"The lookup table maps the estimated energy (kilowatt hours) and carbon emissions (CO2e) to 1 unit of usage, for all the unique combinations of region, service name, usage type and usage unit in the billing data of your cloud provider(s)."),Object(o.b)("p",null,"Once generated, this lookup table (CSV file) can be deployed to your ETL or other data processing pipeline. Then when processing your billing data, you can simply multiply your usage amount by the values in the lookup tables to estimate energy and CO2e. This approach avoids having to use the Cloud Carbon Footprint application code directly, and works regardless of the programming language or environment used in your pipeline."),Object(o.b)("p",null,"To generate this lookup table:"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Make sure you have a CSV file inside the ",Object(o.b)("inlineCode",{parentName:"li"},"cli")," package, that contains all the unique region, service name, usage type and usage unit variations in your billing data, along with the vCPUs for that line item, if it exists. You can see an example of this using AWS data ",Object(o.b)("a",{parentName:"li",href:"https://github.com/cloud-carbon-footprint/cloud-carbon-footprint/blob/trunk/packages/cli/src/__tests__/CreateLookupTable/aws_input.test.csv"},"here"),", and ",Object(o.b)("a",{parentName:"li",href:"#example-queries-to-create-input-csv-file"},"below")," for example queries to create this file."),Object(o.b)("li",{parentName:"ol"},"Run the following:")),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre"},"yarn create-lookup-table <options>\n")),Object(o.b)("p",null,"The options for this command are:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre"},'--awsInput <filename> (required. name of input file, e.g. "aws_input.cvs")\n--awsOutput <filename> (optional, defaults to "aws_lookup_data.csv")\n')),Object(o.b)("p",null,"Currently, only AWS is supported for this functionality."),Object(o.b)("p",null,"We would like to thank ",Object(o.b)("a",{parentName:"p",href:"https://github.com/mfulleratlassian"},"@mfulleratlassian")," for contributing this functionality."),Object(o.b)("h2",{id:"example-queries-to-create-input-csv-file"},"Example queries to create input CSV file"),Object(o.b)("h3",{id:"aws---athena-query"},"AWS - Athena Query"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre"},"SELECT \nline_item_product_code as serviceName,\nproduct_region as region,\nline_item_usage_type as usageType,\npricing_unit as usageUnit,\nproduct_vcpu as vCpus\nFROM <your-cost-and-usage-reports-table>\nWHERE line_item_line_item_type NOT IN ('Usage', 'DiscountedUsage', 'SavingsPlanCoveredUsage')\nAND line_item_usage_start_date >= DATE('YYYY-MM-DD')\nAND line_item_usage_start_date <= DATE('YYYY-MM-DD')\nGROUP BY 1, 2, 3, 4, 5\n")))}p.isMDXComponent=!0}}]);