<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Cloud Carbon Footprint Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Cloud Carbon Footprint Blog Atom Feed"><title data-react-helmet="true">AWS | Cloud Carbon Footprint</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="AWS | Cloud Carbon Footprint"><meta data-react-helmet="true" name="description" content="Your AWS account needs to be configured to generate Cost and Usage reports and save those reports in S3, and the application needs to authenticate with AWS and run queries on that data using Amazon Athena."><meta data-react-helmet="true" property="og:description" content="Your AWS account needs to be configured to generate Cost and Usage reports and save those reports in S3, and the application needs to authenticate with AWS and run queries on that data using Amazon Athena."><meta data-react-helmet="true" property="og:url" content="https://ThoughtWorks-Cleantech.github.io/docs/aws"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://ThoughtWorks-Cleantech.github.io/docs/aws"><link rel="stylesheet" href="/styles.6b48eb87.css">
<link rel="preload" href="/styles.2a2173e7.js" as="script">
<link rel="preload" href="/runtime~main.45e6cbc0.js" as="script">
<link rel="preload" href="/main.e9529763.js" as="script">
<link rel="preload" href="/1.0106049a.js" as="script">
<link rel="preload" href="/2.07fe3381.js" as="script">
<link rel="preload" href="/01a85c17.c7dcd3f4.js" as="script">
<link rel="preload" href="/1be78505.8b817fa5.js" as="script">
<link rel="preload" href="/6875c492.52a06aad.js" as="script">
<link rel="preload" href="/a6aa9e1f.b01fd8d5.js" as="script">
<link rel="preload" href="/c4f5d8e4.eafd3678.js" as="script">
<link rel="preload" href="/ccc49370.bc654064.js" as="script">
<link rel="preload" href="/39.ccf41c90.js" as="script">
<link rel="preload" href="/38.a2c5e7fb.js" as="script">
<link rel="preload" href="/935f2afb.e64a790c.js" as="script">
<link rel="preload" href="/17896441.8f4f1dbb.js" as="script">
<link rel="preload" href="/ea5855c7.40635df0.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Cloud Carbon Footprint</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__link" href="/docs/getting-started">Try Now</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Cloud Carbon Footprint</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link" href="/docs/getting-started">Try Now</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Get Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started">Try Now</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Running Locally</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Running the Web App</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/run-with-mocked-data">Run with Mocked Data</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Connect to Real Data</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/aws">AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gcp">GCP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/azure">Azure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/alternative-data-approaches">Alternative Data Approaches</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/run-with-docker">Run with Docker</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/running-the-cli">Running the CLI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/performance-configuration">Performance Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/deploying">Deploying</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">AWS</h1></header><div class="markdown"><p>Your AWS account needs to be configured to generate Cost and Usage reports and save those reports in S3, and the application needs to authenticate with AWS and run queries on that data using Amazon Athena.</p><ol><li><p>Ensure your aws account has the correct permissions</p><ul><li>You will need an <a href="https://aws.amazon.com/premiumsupport/knowledge-center/create-access-key/" target="_blank" rel="noopener noreferrer">IAM</a> user that can create access-keys and modify your billing settings.</li></ul></li><li><p>Enable the Cost and Usage Billing AWS feature.</p><ul><li>This feature needs to be enabled so your account can start generating cost and usage reports. To enable, navigate to your account&#x27;s billing section, and click on the &quot;Cost and Usage Reports&quot; tab. Make sure to select “Amazon Athena” for report data integration. Reference Cost and Usage Reports documentation <a href="https://docs.aws.amazon.com/cur/latest/userguide/what-is-cur.html" target="_blank" rel="noopener noreferrer">here.</a></li></ul></li><li><p>Setup Athena DB to save the Cost and Usage Reports.</p><ul><li>In addition to generating reports, we use Athena DB to save the details of those reports in a DB, so we can run queries on them. This is a standard AWS integration, outlined <a href="https://docs.aws.amazon.com/cur/latest/userguide/cur-query-athena.html" target="_blank" rel="noopener noreferrer">here.</a></li></ul></li><li><p>Configure aws credentials locally, using awscli.</p><ul><li><p>After <a href="https://github.com/ThoughtWorks-Cleantech/cloud-carbon-footprint#optional-prerequisites" target="_blank" rel="noopener noreferrer">installing awscli</a>, run <code>aws configure</code> and provide your access key and secret access key. Also make sure you select the same region as the one you created your cost and usage reports in.</p></li><li><p>We optionally support alternative methods of authenticating with AWS, which you can read about <a href="https://github.com/ThoughtWorks-Cleantech/cloud-carbon-footprint#options-for-aws-authentication" target="_blank" rel="noopener noreferrer">here.</a></p></li></ul></li><li><p>Configure environmental variables for the api and client.</p><ul><li><p>After configuring your credentials, we need to set a number of environmental variables in the app, so it can authenticate with AWS. We use .env files to manage this. Reference <a href="https://github.com/ThoughtWorks-Cleantech/cloud-carbon-footprint/blob/trunk/packages/api/.env.template" target="_blank" rel="noopener noreferrer">packages/api/.env.template</a> for a template .env file. Rename this file as .env, optionally remove the comments and then set the environment variables for the “Billing Data” approach. If you are only using one of these cloud providers, you can remove the environment variables associated with the other cloud provider in your <code>packgages/api/.env</code> file.</p></li><li><p>There is also a <code>packages/client/.env</code> file that is required to be set if the application is being deployed behind Okta. See <a href="https://github.com/ThoughtWorks-Cleantech/cloud-carbon-footprint/blob/trunk/packages/client/.env.template" target="_blank" rel="noopener noreferrer">client/.env.template</a> for a template. Rename this file as .env, optionally remove the comments and then set the environment variables.</p></li><li><p>By default, the client uses AWS, GCP and Azure. If you are only using one of these cloud providers, please update the appConfig object in the <a href="https://github.com/ThoughtWorks-Cleantech/cloud-carbon-footprint/blob/trunk/packages/client/src/Config.ts" target="_blank" rel="noopener noreferrer">client Config file</a> to only include your provider in the CURRENT_PROVIDERS array.</p></li></ul></li><li><p>Finally, start up the application</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">yarn start</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></li></ol><p>⚠️ This will incur some cost. Use this sparingly if you wish to test with live data.</p><p>DISCLAIMER: If your editor of choice is VS Code, we recommend to use either your native or custom terminal of choice (i.e. iterm) instead. Unexpected authentication issues have occured when starting up the server in VS Code terminals.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="options-for-aws-authentication"></a>Options for AWS Authentication<a class="hash-link" href="#options-for-aws-authentication" title="Direct link to heading">#</a></h3><p>We currently support three modes of authentication with AWS, that you can see in <a href="https://github.com/ThoughtWorks-Cleantech/cloud-carbon-footprint/blob/trunk/packages/core/src/application/AWSCredentialsProvider.ts" target="_blank" rel="noopener noreferrer">packages/core/src/application/AWSCredentialsProvider.ts:</a></p><ol><li><p>&quot;default&quot; - this uses the AWS credentials that exist in the environment the application is running in, for example if you configure your local environment.</p></li><li><p>&quot;AWS&quot; - this is used to authenticate via an AWS role that has the necessary permissions to query the CloudWatch and Cost Explorer APIs.</p></li><li><p>&quot;GCP&quot; - this is used by GCP Service Accounts that authenticate via a temporary AWS STS token. This method is used by the application when deployed to Google App Engine.</p></li></ol><p>The authentication mode is set inside <a href="https://github.com/ThoughtWorks-Cleantech/cloud-carbon-footprint/blob/trunk/packages/core/src/application/Config.ts" target="_blank" rel="noopener noreferrer">packages/core/src/application/Config.ts.</a></p><p>api/.env is where you configure the options for the &quot;GCP&quot; mode, and set the AWS Accounts you want to run the application against. You can read more about this mode of authentication in <a href="https://github.com/ThoughtWorks-Cleantech/cloud-carbon-footprint/blob/trunk/.adr/adr_5_aws_authentication.txt" target="_blank" rel="noopener noreferrer">.adr/adr_5_aws_authentication.txt</a>, as well as this article: <a href="https://cevo.com.au/post/2019-07-29-using-gcp-service-accounts-to-access-aws/" target="_blank" rel="noopener noreferrer">https://cevo.com.au/post/2019-07-29-using-gcp-service-accounts-to-access-aws/</a></p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/run-with-mocked-data"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Run with Mocked Data</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/gcp"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">GCP »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#options-for-aws-authentication" class="table-of-contents__link">Options for AWS Authentication</a></li></ul></div></div></div></div></main></div></div><div><div class="footerImageContainer_2H1A"><div><p class="footerImageTitle_1-0Q">Have a Question?</p><a href="https://groups.google.com/g/cloud-carbon-footprint" target="_blank" rel="noopener noreferrer"><button class="MuiButtonBase-root MuiButton-root jss2 MuiButton-contained" tabindex="0" type="button"><span class="MuiButton-label">JOIN OUR DISCUSSION FORUM</span></button></a></div></div><div class="footerLicenseContainer_dmmY"><p>Cloud Carbon Footprint is an open-source project, sponsored by ThoughtWorks Inc. under the <a class="footerLicenseLink_jTO1" target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a></p><p><a class="footerLicenseLink_jTO1" target="_blank" href="https://www.thoughtworks.com/privacy-policy">PRIVACY POLICY</a></p></div></div></div>
<script src="/styles.2a2173e7.js"></script>
<script src="/runtime~main.45e6cbc0.js"></script>
<script src="/main.e9529763.js"></script>
<script src="/1.0106049a.js"></script>
<script src="/2.07fe3381.js"></script>
<script src="/01a85c17.c7dcd3f4.js"></script>
<script src="/1be78505.8b817fa5.js"></script>
<script src="/6875c492.52a06aad.js"></script>
<script src="/a6aa9e1f.b01fd8d5.js"></script>
<script src="/c4f5d8e4.eafd3678.js"></script>
<script src="/ccc49370.bc654064.js"></script>
<script src="/39.ccf41c90.js"></script>
<script src="/38.a2c5e7fb.js"></script>
<script src="/935f2afb.e64a790c.js"></script>
<script src="/17896441.8f4f1dbb.js"></script>
<script src="/ea5855c7.40635df0.js"></script>
</body>
</html>